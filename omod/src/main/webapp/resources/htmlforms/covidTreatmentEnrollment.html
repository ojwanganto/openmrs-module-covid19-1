<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.

-->

<htmlform>
    <macros></macros>
    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
    <script>

        jq(function () {
            jq('#hospital-isolation').hide();
            jq('.transfer-in').hide();

            jq("#action-taken select").change(actionTakenResponse);
            jq("#patient-type :input[type=radio]").change(patientTypeResponse);

        });

        function actionTakenResponse() {
            var val = jq(this).val();
            if (val == 1654){
                jq('#hospital-isolation').show();
            } else{
                setValue('admission-date.value','');
                clearHiddenSections([jq('#admission-unit')]);

                jq('#hospital-isolation').hide();
            }

        }

        function patientTypeResponse() {
            var val = jq(this).val();
            if (val == 160563){ // if transfer in
                jq('.transfer-in').show();
            } else{ // if new patient
                setValue('referring-hospital.value','');
                setValue('date-tested-positive.value','');
                jq('.transfer-in').hide();
            }

        }

        

        clearHiddenSections = function(parentObj) {
            for(var i=0; i &lt; parentObj.length; i++){
                parentObj[i].find('input[type=radio]').each(function() {
                    this.checked = false;
                });
                parentObj[i].find('input[type=checkbox]').each(function() {
                    this.checked = false;
                });
                parentObj[i].find('input[type=text]').each(function() {
                    this.val("");
                });
                parentObj[i].find('select').each(function() {
                    this.selectedIndex = 0;
                });
            }
        }
    </script>
    <ifMode mode="EDIT">
    <script type="text/javascript">
        jq(document).ready(function(){

        var val = getValue('action-taken.value'); 
        var patientType = getValue('patient-type.value');          
        if (val == 1654){
            jq('#hospital-isolation').show();// this shows the entire fieldset
        }

        if(patientType == 160563) {
            jq('.transfer-in').show();
        }

    });
    </script>
</ifMode>
    <style>


        .disabled {
            color: #ebebe4;
    </style>

    <div class="ke-form-header">
        <table width="100%">
            <tr>
                <td align="left">Enrollment Date:
                    <encounterDate id="encounter-date" showTime="true" />
                </td>
                <td>Enrolled by: <encounterProvider default="currentUser" /></td>

                <td align="right">Location:
                    <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" type="autocomplete"/>
                </td>
            </tr>
        </table>
    </div>

    <div class="ke-form-content">

        <fieldset>
            <legend>Enrollment</legend>
            
            <table>
                <tr>
					<td>Passport/ID Number</td>
					<td colspan="3">
                        <obs id="national_identification" conceptId="163084AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
					</td>
				</tr>
                <tr>
                    <td width="30%"> Case classification</td>
                    <td>
                        <obs required="true" id="status-at-reporting" conceptId="159640AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" "
                             answerConceptIds="5006AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1498AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1499AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1500AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,164830AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             style="radio" answerLabels="Asymptomatic,Mild,Moderate,Severe,Critical"/>
                    </td>
                </tr>
                <tr></tr>
                <tr>
                    <td>Type of patient</td>
                    <td>
                        <obs
                                id="patient-type" conceptId="161641AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" style="radio"
                                answerConceptIds="164144AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,160563AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                answerLabels="New,Transfer in"
                                required="true"
                        />
                    </td>
                </tr>
                
                <tr class="transfer-in">
                    <td> Referral facility </td>
                    <td>
                        <obs id="referring-hospital" conceptId="161550AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" size="50" />
                    </td>
                </tr>
                <tr class="transfer-in">
                    <td> Date confirmed positive </td>
                    <td>
                        <obs id="date-tested-positive" conceptId="159948AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" labelText=" " showTime="false"/>
                    </td>
                </tr>

                <tr>
                    <td>Action taken</td>
                    <td>
                        <obs required="true" id="action-taken"  conceptId="1272AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  labelText=" "
                            answerConceptIds="165901AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1654AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                            answerLabels="Referred to home based treatment/isolation,Hospital admission"/>
                    </td>
                </tr>
                <tr></tr>
                
            </table>
        </fieldset>

        <fieldset id="hospital-isolation">
            <legend>COVID-19 treatment - Hospital treatment</legend>
            <table>
            
                <tr class="admission-detail">
                        <td width="49%">Date of admission</td>
                        <td>
                            <obs id="admission-date" conceptId="1640AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" allowTime="false"/>
                        </td>
                </tr>
                <tr class="admission-detail">
                    <td> Admission unit</td>

                        <td style="text-align: left">
                            <obs conceptId="161010AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerConceptIds="165994AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,165995AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,161936AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                                    answerLabels="Isolation,HDU,ICU" style="radio" id="admission-unit" />
                        </td>
                </tr>
            </table>
        </fieldset>
        <enrollInProgram programId="117093ea-5355-11ec-bf63-0242ac130002"/>
    </div>
    <div class="ke-form-footer">
        <submit/>
    </div>

</htmlform>